<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        
// const posts=[
//     {title:"post one", body:"this is post one",createdAt:new Date().getTime()},
//      {title:"post two", body:"this is post two",createdAt:new Date().getTime()}
//  ];
//  let intervalId=0;

//  function getPosts(){
//     clearInterval(intervalId);
//     intervalId=setInterval(()=>{
//         let output='';
//         posts.forEach((post,index)=>{
//         output=output+`<li>${post.title}-last updated ${(new Date().getTime()-post.createdAt)/1000} ago</li>`;
//         });
//         document.body.innerHTML=output;
//     },1000);
// }
// function createPost(post){
//     return new Promise((resolve,reject)=>{
//         setTimeout(()=>{
//             posts.push({...post,createdAt:new Date().getTime()});
//         let error=true;
//         if(!error){
//             resolve(); //not error
//         }
//         else{
//            reject('error:something went wrong')
//         }
//     },2000);
//     })
// }

//        createPost({title:'post three', body:'this is post three'})
//        .then(getPosts).catch(error=>
//         console.log(error)
//        );





//to delete elements
const posts=[
    {title:"post one", body:"this is post one",createdAt:new Date().getTime()},
     {title:"post two", body:"this is post two",createdAt:new Date().getTime()}
 ];
 let intervalId=0;

 function getPosts(){
    clearInterval(intervalId);
    intervalId=setInterval(()=>{
        let output='';
        posts.forEach((post,index)=>{
        output=output+`<li>${post.title}-last updated ${(new Date().getTime()-post.createdAt)/1000} ago</li>`;
        });
        document.body.innerHTML=output;
    },1000);
}
function createPost(post){
    return new Promise((resolve,reject)=>{
        setTimeout(()=>{
            posts.push({...post,createdAt:new Date().getTime()});
        let error=false;
        if(!error){
            resolve(); //not error
        }
        else{
           reject('error:something went wrong')
        }
    },2000);
    })
}

function create4thPost(post){
    setTimeout(()=>{
        posts.push({...post,createdAt:new Date().getTime()});
       
    },3000);
}   
function deletePost(){
    return new Promise((resolve,reject)=>{
        setTimeout(()=>{
            if(posts.length>0){
                let lastElement=posts.pop();
                resolve(lastElement)
            }else{
                reject('array is empty')
            }
        },2000)
    })
}  
       create4thPost({title:"post four",body:"this is post four"})
       createPost({title:'post three', body:'this is post three'})
       .then(()=>{
        getPosts();
        deletePost().then(()=>{
            getPosts();
            deletePost().then(()=>{
                getPosts();
                deletePost().then(()=>{
                    getPosts();
                })
                deletePost().then(()=>{}).catch((error)=>{
                    console.log('inside catch block',error)
                })
            }).catch(error=>
        console.log(error)
       );
        }).catch(error=>
        console.log(error)
       );
       }).catch(error=>
        console.log(error)
       );
    </script>
</body>
</html>